<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡¨åºŠè©¦é©—ç®¡ç†ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }
        .shake { animation: shake 0.5s; }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-blue-50">
    <div id="app"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // å®‰å…¨é…ç½®
        const SECURITY_CONFIG = {
            ACCESS_PASSWORD: 'clinical2026',  // è¨ªå•å¯†ç¢¼ï¼ˆå¯ä»¥æ”¹æˆä»»ä½•ä½ æƒ³è¦çš„ï¼‰
            ADMIN_USERNAME: 'admin',          // ç®¡ç†å“¡å¸³è™Ÿ
            ADMIN_PASSWORD: 'admin123',       // ç®¡ç†å“¡å¯†ç¢¼
            ENCRYPTION_KEY: 'clinical-trials-secret-key-2026' // åŠ å¯†é‡‘é‘°
        };

        // åŠ å¯†å‡½æ•¸
        const encryptData = (data) => {
            try {
                return CryptoJS.AES.encrypt(JSON.stringify(data), SECURITY_CONFIG.ENCRYPTION_KEY).toString();
            } catch (error) {
                console.error('åŠ å¯†å¤±æ•—:', error);
                return null;
            }
        };

        // è§£å¯†å‡½æ•¸
        const decryptData = (encryptedData) => {
            try {
                const bytes = CryptoJS.AES.decrypt(encryptedData, SECURITY_CONFIG.ENCRYPTION_KEY);
                const decryptedString = bytes.toString(CryptoJS.enc.Utf8);
                return JSON.parse(decryptedString);
            } catch (error) {
                console.error('è§£å¯†å¤±æ•—:', error);
                return null;
            }
        };

        // SVG Icons
        const SearchIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>;
        const FilterIcon = () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" /></svg>;
        const LoginIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" /></svg>;
        const LogoutIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>;
        const EditIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>;
        const PlusIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" /></svg>;
        const TrashIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>;
        const SaveIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" /></svg>;
        const XIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" /></svg>;
        const CheckCircleIcon = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
        const XCircleIcon = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
        const AlertCircleIcon = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
        const DownloadIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>;
        const FileTextIcon = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>;
        const LockIcon = () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>;
        const ShieldIcon = () => <svg className="w-20 h-20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>;

        // åˆå§‹æ•¸æ“šï¼ˆå·²åŒ¿ååŒ–ï¼‰
        const initialTrials = [
  {"id": 1, "cancerType": "è‚ç™Œ", "line": "äºŒã€ä¸‰ç·š", "studyTitle": "ä¸€é …ç¬¬IIæœŸã€å¤šä¸­å¿ƒã€é–‹æ”¾æ€§è©¦é©—ï¼Œåœ¨æ‚£æœ‰æ™šæœŸ/è½‰ç§»æ€§å¯¦é«”è…«ç˜¤çš„åƒèˆ‡è€…ä¸­è©•ä¼°DB-1311ä½µç”¨BNT327æˆ–DB-1305", "code": "DB1311-201", "phase": "I", "sponsor": "", "targetNum": 6, "enrolled": 0, "monthSigned": 0, "monthEnrolled": 0, "pi": "æ¥Šæ…•è¯", "nurse": "Abby", "phone": "82935/82999", "status": "é€²è¡Œä¸­", "criteria": "Part I: 1.å¾©ç™¼è½‰ç§»å¾Œä¸€æˆ–äºŒç·šå¤±æ•—çš„ç—…äºº 2.Child-Pugh class A 3.HBsAg(+)å¯ä»¥æ”¶,HBV DNA< 500 IU/mL"},
  {"id": 2, "cancerType": "èƒƒç™Œ", "line": "Adjuvant", "studyTitle": "èƒƒç™Œè¡“å¾Œç¬¬äºŒ, ä¸‰A, ä¸‰B æœŸæ‚£è€…æ¥å—S-1 (ä¸‰é€±è™•æ–¹) è¡“å¾Œè¼”åŠ©æ€§æ²»ç™‚ä¹‹è§€å¯Ÿæ€§è©¦é©—", "code": "TTY", "phase": "4", "sponsor": "TTY", "targetNum": 150, "enrolled": 16, "monthSigned": 1, "monthEnrolled": 1, "pi": "æ´ªé€¸å¹³", "nurse": "å®‹ç§€è–‡", "phone": "2935/2999", "status": "é€²è¡Œä¸­", "criteria": "èƒƒç™Œè¡“å¾Œä½¿ç”¨å¥ä¿S-1 ç—…æ‚£"},
  {"id": 3, "cancerType": "èƒƒç™Œ", "line": "Adjuvant", "studyTitle": "ä¸€é …åœ¨ HER2 è¡¨ç¾èƒƒç™Œæ‚£è€…è©•ä¼°æ²»ç™‚æ€§ç™Œç—‡ç–«è‹— (AST-301, pNGVL3-hICD) å®‰å…¨æ€§åŠå…ç–«ç™‚æ•ˆçš„ç¬¬äºŒæœŸè©¦é©— (CORNERSTONE-003)", "code": "PN-301-22", "phase": "2", "sponsor": "è«¾ä½›è‘›", "targetNum": 6, "enrolled": 5, "monthSigned": 0, "monthEnrolled": 0, "pi": "é™³æ˜æ™ƒ", "nurse": "è³´å§µå¦¤", "phone": "0919801912", "status": "é€²è¡Œä¸­", "criteria": "1.èƒƒç™Œè¡“å¾ŒD2ã€R0ã€STAGE 2ã€3 ï¼Œä¸¦ä½¿ç”¨éé é˜²æ€§åŒ–ç™‚å¾Œå®Œå…¨æ²’æœ‰è…«ç˜¤å¾©ç™¼çš„ç—…äººã€‚2.å¿…é ˆç”¨å®Œæœ€å¾Œä¸€æ¬¡é é˜²æ€§åŒ–ç™‚å¾Œï¼Œé–“éš”å…©å‘¨ä¸¦åœ¨å…«å‘¨å…§æ¥å—ç¬¬ä¸€æ¬¡AST-301æ²»ç™‚ã€‚3.HbsAg (+)å¯æ”¶ï¼Œä½†éœ€ HBV DNA is undetectableã€‚"},
  {"id": 4, "cancerType": "èƒƒç™Œ", "line": "ä¸€ç·š", "studyTitle": "ä¸€é …éš¨æ©Ÿåˆ†é…ã€ç¬¬ III æœŸè©¦é©—ï¼Œè©•ä¼° Rilvegostomig ä½µç”¨Fluoropyrimidine å’Œ Trastuzumab Deruxtecan ç›¸è¼ƒæ–¼Trastuzumabã€åŒ–ç™‚å’Œ Pembrolizumab ä½œç‚º HER2 é™½æ€§èƒƒç™Œç¬¬ä¸€ç·šæ²»ç™‚çš„æ•ˆæœ", "code": "D702AC00001", "phase": "III", "sponsor": "AZ", "targetNum": 5, "enrolled": 0, "monthSigned": 0, "monthEnrolled": 0, "pi": "é™³æ˜æ™ƒ", "nurse": "ç‹ç§‹çœ‰", "phone": "0927751328", "status": "é€²è¡Œä¸­", "criteria": "1. HER2 (+)éœ€åœ¨é€åœ‹å¤–é©—Her-2 ,Slide*15ç‰‡(14å¤©å‡ºå ±å‘Š) 2. é«”é‡ >= 35 KG 3. Measurable lesion by RECIST 1.1"},
  {"id": 5, "cancerType": "èƒƒç™Œ", "line": "ä¸€ç·š", "studyTitle": "ä¸€é …ç¬¬ 2 æœŸéš¨æ©Ÿåˆ†é…è©¦é©—ï¼Œé‡å°å±€éƒ¨æ™šæœŸç„¡æ³•åˆ‡é™¤æˆ–è½‰ç§»æ€§èƒƒè…ºç™Œã€èƒƒé£Ÿé“äº¤ç•Œè™•è…ºç™Œæˆ–é£Ÿé“è…ºç™Œæ‚£è€…ï¼Œè©•ä¼° ABBV-400 åˆä½µ Fluorouracilã€Leucovorin å’Œ Budigalimab ä½œç‚ºç¬¬ä¸€ç·šæ²»ç™‚", "code": "M24-977", "phase": "II", "sponsor": "ABBVIE", "targetNum": 10, "enrolled": 10, "monthSigned": 0, "monthEnrolled": 0, "pi": "é™³æ˜æ™ƒ", "nurse": "ç‹ç§‹çœ‰", "phone": "0927751328", "status": "æš«åœæ”¶æ¡ˆ", "criteria": "1.HER2(-) 2.Cè‚ä¸æ”¶ 3.Slide*15 (4-5u)"},
  {"id": 6, "cancerType": "èƒƒç™Œ", "line": "äºŒç·š", "studyTitle": "HERTHENA-PanTumor01ï¼šä¸€é …ç¬¬ 2 æœŸã€å¤šä¸­å¿ƒã€å¤šç¾¤çµ„ã€é–‹æ”¾æ¨™è¨˜ã€æ¦‚å¿µé©—è­‰è©¦é©—ï¼Œæ¢è¨ Patritumab Deruxtecan é‹ç”¨æ–¼å±€éƒ¨æ™šæœŸæˆ–è½‰ç§»æ€§å›ºé«”è…«ç˜¤çš„å—è©¦è€…", "code": "U31402-277", "phase": "II", "sponsor": "ç¬¬ä¸€ä¸‰å…±", "targetNum": 10, "enrolled": 4, "monthSigned": 0, "monthEnrolled": 0, "pi": "æ¥Šæ…•è¯", "nurse": "é‚±ç³ç³", "phone": "0976107317", "status": "é€²è¡Œä¸­", "criteria": "1.HER 2 (-) 2.éœ€è¦PDå¾Œçš„åˆ‡ç‰‡(8ç‰‡) 3.ç¬¬ä¸€ç·šçš„åŒ–ç™‚è¦ä»¥ 5-FU-based"},
  {"id": 7, "cancerType": "èƒƒç™Œ", "line": "ä¸‰ç·š", "studyTitle": "ä¸€é …ç¬¬äºŒæœŸã€é–‹æ”¾æ€§ã€å¤šä¸­å¿ƒè©¦é©—ï¼Œè©•ä¼° AZD0901 ä½œç‚ºå–®ä¸€ç™‚æ³•å’Œä½µç”¨æŠ—ç™Œè—¥ç‰©ä½¿ç”¨æ–¼è¡¨ç¾ Claudin 18.2 ä¹‹æ™šæœŸå¯¦é«”è…«ç˜¤å—è©¦è€…", "code": "D9802C00001", "phase": "III", "sponsor": "AZ", "targetNum": 17, "enrolled": 12, "monthSigned": 0, "monthEnrolled": 0, "pi": "é™³æ˜æ™ƒ", "nurse": "å³ä½³å‹³", "phone": "0918696523", "status": "é€²è¡Œä¸­", "criteria": "æ”¶æ¡ˆå³å°‡é€²å…¥å°¾è² (3/31)ï¼Œå‹•èµ·ä¾†å†åŠ ç¢¼æ”¶ 5äºº~"},
  {"id": 8, "cancerType": "é£Ÿé“ç™Œ", "line": "ä¸€ç·š", "studyTitle": "ä¸€é …é‡å°ç½¹æ‚£å±€éƒ¨æ™šæœŸä¸å¯åˆ‡é™¤ï¼è½‰ç§»æ€§é£Ÿé“ç™Œ ( ESCC) çš„ç¬¬ä¸€ç·šæ²»ç™‚å—è©¦è€…ï¼Œä½¿ç”¨ç ”ç©¶æ€§è—¥ç‰©ä½µç”¨ Pembrolizumabï¼ˆMK-3475ï¼‰æ­é…æˆ–ä¸æ­é…åŒ–å­¸æ²»ç™‚", "code": "MK-3475-06E", "phase": "I/II", "sponsor": "MSD", "targetNum": 5, "enrolled": 0, "monthSigned": 0, "monthEnrolled": 0, "pi": "é™³æ˜æ™ƒ", "nurse": "å­”äº­æ–¹", "phone": "0981764403", "status": "é€²è¡Œä¸­", "criteria": "ç¶“éçµ„ç¹”å­¸æˆ–ç´°èƒå­¸ç¢ºè¨ºç‚ºç¬¬ 1 ç·šæ²»ç™‚ä¸­çš„å±€éƒ¨æ™šæœŸä¸å¯åˆ‡é™¤æˆ–è½‰ç§»æ€§é£Ÿé“é±—ç‹€ç´°èƒç™Œ"},
  {"id": 9, "cancerType": "é£Ÿé“ç™Œ", "line": "äºŒç·š", "studyTitle": "ä¸€é …é‡å° Ifinatamab Deruxtecan (I-DXd) ç”¨æ–¼å…ˆå‰æ›¾æ¥å—éæ²»ç™‚çš„æ™šæœŸæˆ–è½‰ç§»æ€§é£Ÿé“é±—ç‹€ç´°èƒç™Œ (ESCC) å—è©¦è€…ä¹‹ç¬¬ä¸‰æœŸè©¦é©—", "code": "DS7300-202", "phase": "III", "sponsor": "DAIICHI SANKYO", "targetNum": 4, "enrolled": 0, "monthSigned": 0, "monthEnrolled": 0, "pi": "é™³æ˜æ™ƒ", "nurse": "å­”äº­æ–¹", "phone": "0981764403", "status": "é€²è¡Œä¸­", "criteria": "Has disease progression post platinum-based and ICI treatment"},
  {"id": 10, "cancerType": "èƒ°è‡Ÿç™Œ", "line": "ä¸€ç·š", "studyTitle": "ä¸€é …ç¬¬ 2b/3 æœŸã€éš¨æ©Ÿåˆ†é…ã€é›™ç›²è©¦é©—,é‡å°æ¥å—èƒŒæ™¯ç¬¬ä¸€ç·šåŒ–ç™‚çš„æƒ¡ç—…è³ªå’Œè½‰ç§»æ€§èƒ°ç®¡è…ºç™Œæˆäººåƒèˆ‡è€…", "code": "C3651021", "phase": "2b/3", "sponsor": "è¼ç‘", "targetNum": 15, "enrolled": 1, "monthSigned": 1, "monthEnrolled": 0, "pi": "æé‡è³“", "nurse": "å¼µå°ä¾", "phone": "0972811090", "status": "é€²è¡Œä¸­", "criteria": "è³‡æ–™é¡¯ç¤ºæœ‰è½‰ç§»æ€§èƒ°ç®¡è…ºç™Œï¼Œå°šæœªæ¥å—éæ²»ç™‚"},
  {"id": 11, "cancerType": "è†½é“ç™Œ", "line": "ä¸€ç·š", "studyTitle": "ä¸€é …ç¬¬ III æœŸã€éš¨æ©Ÿåˆ†é…ã€é–‹æ”¾æ€§ã€å…¨çƒå¤šä¸­å¿ƒè©¦é©—ï¼Œè©•ä¼°Rilvegostomig æˆ– Durvalumab ä½µç”¨åŒ–ç™‚ä½œç‚ºæ™šæœŸè†½é“ç™Œæ‚£è€…çš„ç¬¬ä¸€ç·šæ²»ç™‚", "code": "D702NC00001", "phase": "III", "sponsor": "AZ", "targetNum": 15, "enrolled": 0, "monthSigned": 0, "monthEnrolled": 0, "pi": "é™³æ˜æ™ƒ", "nurse": "æ—éŸ‹ç§€", "phone": "0963501682", "status": "é€²è¡Œä¸­", "criteria": "ç¶“çµ„ç¹”å­¸ç¢ºèªæ‚£æœ‰è†½é“ç·šç™Œï¼ŒåŒ…æ‹¬ iCCAã€eCCAå’Œè†½é“ç™Œ"},
  {"id": 12, "cancerType": "å¤§è…¸ç™Œ", "line": "ä¸€ç·š", "studyTitle": "ä¸€é …ç¬¬ 3 æœŸã€éš¨æ©Ÿåˆ†é…ã€é–‹æ”¾æ€§ã€å¤šä¸­å¿ƒè‡¨åºŠè©¦é©—ï¼Œè©•ä¼° MK-1084ã€Cetuximab å’Œ mFOLFOX6 ç›¸è¼ƒæ–¼ mFOLFOX6 ä½µç”¨æˆ–ä¸ä½µç”¨Bevacizumab", "code": "MK-1082-012", "phase": "III", "sponsor": "MSD", "targetNum": 4, "enrolled": 2, "monthSigned": 2, "monthEnrolled": 2, "pi": "é„§è±ªå‰", "nurse": "å¼µå°ä¾", "phone": "0972811090", "status": "é€²è¡Œä¸­", "criteria": "Stage III or IV, KRAS G12C mutation (+) CRC"},
  {"id": 13, "cancerType": "å¤§è…¸ç™Œ", "line": "äºŒç·š", "studyTitle": "ä¸€é …ç¬¬2 æœŸã€éš¨æ©Ÿåˆ†é…è©¦é©—ï¼Œå°æ–¼æ›¾æ¥å—æ²»ç™‚ä¹‹ç„¡æ³•åˆ‡é™¤è½‰ç§»æ€§çµè…¸ç›´è…¸ç™Œå—è©¦è€…ï¼Œè©•ä¼°ABBV-400 åˆä½µFluorouracilã€Folinic Acid å’ŒBevacizumab", "code": "M24-311", "phase": "II", "sponsor": "Abbvie", "targetNum": 5, "enrolled": 5, "monthSigned": 0, "monthEnrolled": 0, "pi": "é„§è±ªå‰", "nurse": "é™³ç§€ç²", "phone": "0988660381", "status": "é€²è¡Œä¸­", "criteria": "BRAF V600E no mutation and microsatellite stable, MSS"}
];

        // è¨ªå•å¯†ç¢¼é©—è­‰çµ„ä»¶
        function AccessPasswordScreen({ onAccessGranted }) {
          const [password, setPassword] = useState('');
          const [error, setError] = useState(false);

          const handleSubmit = (e) => {
            e.preventDefault();
            if (password === SECURITY_CONFIG.ACCESS_PASSWORD) {
              sessionStorage.setItem('access_granted', 'true');
              onAccessGranted();
            } else {
              setError(true);
              setPassword('');
              setTimeout(() => setError(false), 500);
            }
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-900 via-indigo-900 to-purple-900 flex items-center justify-center p-4">
              <div className={`bg-white rounded-3xl shadow-2xl p-12 max-w-md w-full ${error ? 'shake' : ''}`}>
                <div className="text-center mb-8">
                  <div className="inline-block p-4 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full mb-6">
                    <ShieldIcon />
                  </div>
                  <h1 className="text-3xl font-bold text-slate-800 mb-2">
                    è‡¨åºŠè©¦é©—ç®¡ç†ç³»çµ±
                  </h1>
                  <p className="text-slate-600">æ­¤ç³»çµ±å—å¯†ç¢¼ä¿è­·</p>
                </div>

                <form onSubmit={handleSubmit} className="space-y-6">
                  <div>
                    <label className="block text-sm font-semibold text-slate-700 mb-2">
                      <div className="flex items-center gap-2">
                        <LockIcon />
                        è¨ªå•å¯†ç¢¼
                      </div>
                    </label>
                    <input
                      type="password"
                      value={password}
                      onChange={(e) => setPassword(e.target.value)}
                      className={`w-full px-4 py-3 border-2 ${error ? 'border-red-500' : 'border-slate-300'} rounded-xl focus:border-blue-500 focus:outline-none transition-colors text-lg`}
                      placeholder="è«‹è¼¸å…¥è¨ªå•å¯†ç¢¼"
                      autoFocus
                    />
                    {error && (
                      <p className="text-red-500 text-sm mt-2">âŒ å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹é‡è©¦</p>
                    )}
                  </div>

                  <button
                    type="submit"
                    className="w-full px-6 py-4 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl hover:from-blue-600 hover:to-indigo-700 transition-all shadow-lg hover:shadow-xl font-semibold text-lg"
                  >
                    é€²å…¥ç³»çµ±
                  </button>
                </form>

                <div className="mt-8 p-4 bg-blue-50 rounded-xl border border-blue-200">
                  <p className="text-xs text-slate-600 text-center">
                    ğŸ”’ æ­¤ç³»çµ±ä½¿ç”¨ AES-256 åŠ å¯†ä¿è­·æ•¸æ“š<br/>
                    å¦‚å¿˜è¨˜å¯†ç¢¼è«‹è¯ç¹«ç³»çµ±ç®¡ç†å“¡
                  </p>
                </div>
              </div>
            </div>
          );
        }

        function ClinicalTrialsManager() {
          const [hasAccess, setHasAccess] = useState(false);
          const [trials, setTrials] = useState([]);
          const [filteredTrials, setFilteredTrials] = useState([]);
          const [searchTerm, setSearchTerm] = useState('');
          const [selectedCancer, setSelectedCancer] = useState('å…¨éƒ¨');
          const [selectedLine, setSelectedLine] = useState('å…¨éƒ¨');
          const [selectedStatus, setSelectedStatus] = useState('å…¨éƒ¨');
          const [isLoggedIn, setIsLoggedIn] = useState(false);
          const [showLoginModal, setShowLoginModal] = useState(false);
          const [username, setUsername] = useState('');
          const [password, setPassword] = useState('');
          const [editingTrial, setEditingTrial] = useState(null);
          const [showAddModal, setShowAddModal] = useState(false);
          const [loading, setLoading] = useState(true);

          useEffect(() => {
            // æª¢æŸ¥æ˜¯å¦å·²é€šéè¨ªå•å¯†ç¢¼é©—è­‰
            const accessGranted = sessionStorage.getItem('access_granted');
            if (accessGranted === 'true') {
              setHasAccess(true);
              loadTrialsFromStorage();
            } else {
              setLoading(false);
            }
          }, []);

          const loadTrialsFromStorage = () => {
            try {
              const storedData = localStorage.getItem('clinical-trials-encrypted');
              if (storedData) {
                const decryptedTrials = decryptData(storedData);
                if (decryptedTrials && Array.isArray(decryptedTrials)) {
                  setTrials(decryptedTrials);
                  setFilteredTrials(decryptedTrials);
                } else {
                  // è§£å¯†å¤±æ•—ï¼Œä½¿ç”¨åˆå§‹æ•¸æ“š
                  saveTrialsToStorage(initialTrials);
                  setTrials(initialTrials);
                  setFilteredTrials(initialTrials);
                }
              } else {
                // ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œä¿å­˜åˆå§‹æ•¸æ“š
                saveTrialsToStorage(initialTrials);
                setTrials(initialTrials);
                setFilteredTrials(initialTrials);
              }
            } catch (error) {
              console.error('è¼‰å…¥å¤±æ•—:', error);
              // å‡ºéŒ¯æ™‚ä½¿ç”¨åˆå§‹æ•¸æ“š
              saveTrialsToStorage(initialTrials);
              setTrials(initialTrials);
              setFilteredTrials(initialTrials);
            } finally {
              setLoading(false);
            }
          };

          const saveTrialsToStorage = (trialsData) => {
            try {
              const encrypted = encryptData(trialsData);
              if (encrypted) {
                localStorage.setItem('clinical-trials-encrypted', encrypted);
              }
            } catch (error) {
              console.error('ä¿å­˜å¤±æ•—:', error);
            }
          };

          useEffect(() => {
            let filtered = trials;

            if (selectedCancer !== 'å…¨éƒ¨') {
              filtered = filtered.filter(t => t.cancerType === selectedCancer);
            }

            if (selectedLine !== 'å…¨éƒ¨') {
              filtered = filtered.filter(t => t.line.includes(selectedLine));
            }

            if (selectedStatus !== 'å…¨éƒ¨') {
              filtered = filtered.filter(t => t.status === selectedStatus);
            }

            if (searchTerm) {
              filtered = filtered.filter(t =>
                t.studyTitle.toLowerCase().includes(searchTerm.toLowerCase()) ||
                t.code.toLowerCase().includes(searchTerm.toLowerCase()) ||
                t.sponsor.toLowerCase().includes(searchTerm.toLowerCase()) ||
                t.pi.toLowerCase().includes(searchTerm.toLowerCase())
              );
            }

            setFilteredTrials(filtered);
          }, [trials, selectedCancer, selectedLine, selectedStatus, searchTerm]);

          const handleLogin = () => {
            if (username === SECURITY_CONFIG.ADMIN_USERNAME && password === SECURITY_CONFIG.ADMIN_PASSWORD) {
              setIsLoggedIn(true);
              setShowLoginModal(false);
              setUsername('');
              setPassword('');
            } else {
              alert('å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤');
            }
          };

          const handleLogout = () => {
            setIsLoggedIn(false);
          };

          const handleEdit = (trial) => {
            setEditingTrial({ ...trial });
          };

          const handleSaveEdit = () => {
            const updatedTrials = trials.map(t =>
              t.id === editingTrial.id ? editingTrial : t
            );
            setTrials(updatedTrials);
            saveTrialsToStorage(updatedTrials);
            setEditingTrial(null);
          };

          const handleDelete = (id) => {
            if (window.confirm('ç¢ºå®šè¦åˆªé™¤æ­¤è©¦é©—å—ï¼Ÿ')) {
              const updatedTrials = trials.filter(t => t.id !== id);
              setTrials(updatedTrials);
              saveTrialsToStorage(updatedTrials);
            }
          };

          const handleAdd = (newTrial) => {
            const trialWithId = {
              ...newTrial,
              id: Math.max(...trials.map(t => t.id), 0) + 1
            };
            const updatedTrials = [...trials, trialWithId];
            setTrials(updatedTrials);
            saveTrialsToStorage(updatedTrials);
            setShowAddModal(false);
          };

          const downloadCSV = () => {
            const headers = ['ç™Œç—‡é¡å‹', 'æ²»ç™‚ç·šåˆ¥', 'è©¦é©—åç¨±', 'ä»£è™Ÿ', 'æœŸåˆ¥', 'è´ŠåŠ©å•†', 'ç›®æ¨™äººæ•¸', 'å·²æ”¶æ¡ˆ', 'ç•¶æœˆç°½ç½²', 'ç•¶æœˆå…¥æ¡ˆ', 'ä¸»æŒäºº', 'ç ”ç©¶è­·å£«', 'é›»è©±', 'ç‹€æ…‹', 'æ”¶æ¡ˆæ¢ä»¶'];
            
            const csvContent = [
              headers.join(','),
              ...filteredTrials.map(trial => [
                trial.cancerType,
                trial.line,
                `"${trial.studyTitle.replace(/"/g, '""')}"`,
                trial.code,
                trial.phase,
                trial.sponsor,
                trial.targetNum,
                trial.enrolled,
                trial.monthSigned,
                trial.monthEnrolled,
                trial.pi,
                trial.nurse,
                trial.phone,
                trial.status,
                `"${trial.criteria.replace(/"/g, '""')}"`
              ].join(','))
            ].join('\n');

            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `è‡¨åºŠè©¦é©—åˆ—è¡¨_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
          };

          const generatePDF = () => {
            const printWindow = window.open('', '_blank');
            const htmlContent = `
              <!DOCTYPE html>
              <html>
                <head>
                  <meta charset="UTF-8">
                  <title>è‡¨åºŠè©¦é©—åˆ—è¡¨</title>
                  <style>
                    @page { size: A4 landscape; margin: 1cm; }
                    body { font-family: "Microsoft JhengHei", Arial, sans-serif; font-size: 9pt; }
                    h1 { text-align: center; color: #1e40af; margin-bottom: 20px; }
                    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
                    th { background-color: #1e40af; color: white; padding: 8px; text-align: left; font-weight: bold; border: 1px solid #ddd; }
                    td { padding: 6px; border: 1px solid #ddd; font-size: 8pt; }
                    tr:nth-child(even) { background-color: #f9fafb; }
                    .status-active { color: #059669; font-weight: bold; }
                    .status-paused { color: #d97706; font-weight: bold; }
                    .status-full { color: #dc2626; font-weight: bold; }
                    .header-info { text-align: center; margin-bottom: 15px; color: #64748b; }
                  </style>
                </head>
                <body>
                  <h1>è‡¨åºŠè©¦é©—ç®¡ç†åˆ—è¡¨</h1>
                  <div class="header-info">åŒ¯å‡ºæ—¥æœŸ: ${new Date().toLocaleDateString('zh-TW')} | å…± ${filteredTrials.length} é …è©¦é©—</div>
                  <table>
                    <thead>
                      <tr>
                        <th>ç™Œç—‡é¡å‹</th>
                        <th>ç·šåˆ¥</th>
                        <th>è©¦é©—åç¨±</th>
                        <th>ä»£è™Ÿ</th>
                        <th>æœŸåˆ¥</th>
                        <th>è´ŠåŠ©å•†</th>
                        <th>ç›®æ¨™äººæ•¸</th>
                        <th>å·²æ”¶æ¡ˆ</th>
                        <th>ä¸»æŒäºº</th>
                        <th>è­·å£«</th>
                        <th>ç‹€æ…‹</th>
                      </tr>
                    </thead>
                    <tbody>
                      ${filteredTrials.map(trial => `
                        <tr>
                          <td>${trial.cancerType}</td>
                          <td>${trial.line}</td>
                          <td style="max-width: 250px;">${trial.studyTitle}</td>
                          <td>${trial.code}</td>
                          <td>${trial.phase}</td>
                          <td>${trial.sponsor}</td>
                          <td>${trial.enrolled}/${trial.targetNum}</td>
                          <td>${trial.targetNum > 0 ? ((trial.enrolled/trial.targetNum)*100).toFixed(0) : 0}%</td>
                          <td>${trial.pi}</td>
                          <td>${trial.nurse}</td>
                          <td class="status-${trial.status === 'é€²è¡Œä¸­' ? 'active' : trial.status === 'æš«åœæ”¶æ¡ˆ' ? 'paused' : 'full'}">${trial.status}</td>
                        </tr>
                      `).join('')}
                    </tbody>
                  </table>
                </body>
              </html>
            `;
            
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            printWindow.onload = () => {
              printWindow.print();
            };
          };

          if (!hasAccess) {
            return <AccessPasswordScreen onAccessGranted={() => setHasAccess(true)} />;
          }

          const cancerTypes = ['å…¨éƒ¨', 'è‚ç™Œ', 'èƒƒç™Œ', 'é£Ÿé“ç™Œ', 'èƒ°è‡Ÿç™Œ', 'è†½é“ç™Œ', 'å¤§è…¸ç™Œ'];
          const lineTypes = ['å…¨éƒ¨', 'ä¸€ç·š', 'äºŒç·š', 'ä¸‰ç·š', 'Adjuvant'];
          const statusTypes = ['å…¨éƒ¨', 'é€²è¡Œä¸­', 'æš«åœæ”¶æ¡ˆ', 'åé¡å·²æ»¿'];

          const getStatusColor = (status) => {
            switch (status) {
              case 'é€²è¡Œä¸­': return 'text-emerald-600 bg-emerald-50';
              case 'æš«åœæ”¶æ¡ˆ': return 'text-amber-600 bg-amber-50';
              case 'åé¡å·²æ»¿': return 'text-rose-600 bg-rose-50';
              default: return 'text-gray-600 bg-gray-50';
            }
          };

          const getStatusIcon = (status) => {
            switch (status) {
              case 'é€²è¡Œä¸­': return <CheckCircleIcon />;
              case 'æš«åœæ”¶æ¡ˆ': return <AlertCircleIcon />;
              case 'åé¡å·²æ»¿': return <XCircleIcon />;
              default: return null;
            }
          };

          if (loading) {
            return (
              <div className="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center">
                <div className="text-center">
                  <div className="animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-4"></div>
                  <div className="text-2xl font-semibold text-slate-600">è¼‰å…¥ä¸­...</div>
                </div>
              </div>
            );
          }

          return (
            <div className="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50">
              <header className="bg-white shadow-md border-b-4 border-blue-500">
                <div className="max-w-7xl mx-auto px-6 py-6">
                  <div className="flex justify-between items-center">
                    <div>
                      <div className="flex items-center gap-3">
                        <h1 className="text-4xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                          è‡¨åºŠè©¦é©—ç®¡ç†ç³»çµ±
                        </h1>
                        <span className="px-3 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full flex items-center gap-1">
                          <LockIcon className="w-3 h-3" />
                          å·²åŠ å¯†
                        </span>
                      </div>
                      <p className="text-slate-600 mt-2">Clinical Trials Management System - Secure Edition</p>
                    </div>
                    <div className="flex gap-3">
                      {isLoggedIn && (
                        <button
                          onClick={() => setShowAddModal(true)}
                          className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 font-semibold"
                          title="æ–°å¢è‡¨åºŠè©¦é©—"
                        >
                          <PlusIcon />
                          æ–°å¢è©¦é©—
                        </button>
                      )}
                      {isLoggedIn ? (
                        <button
                          onClick={handleLogout}
                          className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-rose-500 to-pink-500 text-white rounded-xl hover:from-rose-600 hover:to-pink-600 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                        >
                          <LogoutIcon />
                          ç™»å‡º
                        </button>
                      ) : (
                        <button
                          onClick={() => setShowLoginModal(true)}
                          className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl hover:from-blue-600 hover:to-indigo-600 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                        >
                          <LoginIcon />
                          ç®¡ç†å“¡ç™»å…¥
                        </button>
                      )}
                    </div>
                  </div>
                </div>
              </header>

              <div className="max-w-7xl mx-auto px-6 py-8">
                <div className="bg-white rounded-2xl shadow-xl p-6 mb-8 border border-slate-200">
                  <div className="flex items-center gap-3 mb-6">
                    <FilterIcon />
                    <h2 className="text-2xl font-bold text-slate-800">ç¯©é¸æ¢ä»¶</h2>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div className="md:col-span-4">
                      <div className="relative">
                        <div className="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400">
                          <SearchIcon />
                        </div>
                        <input
                          type="text"
                          placeholder="æœå°‹è©¦é©—åç¨±ã€ä»£è™Ÿã€è´ŠåŠ©å•†ã€ä¸»æŒäºº..."
                          value={searchTerm}
                          onChange={(e) => setSearchTerm(e.target.value)}
                          className="w-full pl-12 pr-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-500 focus:outline-none transition-colors text-lg"
                        />
                      </div>
                    </div>

                    <div>
                      <label className="block text-sm font-semibold text-slate-700 mb-2">ç™Œç—‡ç¨®é¡</label>
                      <select
                        value={selectedCancer}
                        onChange={(e) => setSelectedCancer(e.target.value)}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-500 focus:outline-none transition-colors text-lg font-medium"
                      >
                        {cancerTypes.map(type => (
                          <option key={type} value={type}>{type}</option>
                        ))}
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm font-semibold text-slate-700 mb-2">æ²»ç™‚ç·šåˆ¥</label>
                      <select
                        value={selectedLine}
                        onChange={(e) => setSelectedLine(e.target.value)}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-500 focus:outline-none transition-colors text-lg font-medium"
                      >
                        {lineTypes.map(type => (
                          <option key={type} value={type}>{type}</option>
                        ))}
                      </select>
                    </div>

                    <div>
                      <label className="block text-sm font-semibold text-slate-700 mb-2">æ”¶æ¡ˆç‹€æ…‹</label>
                      <select
                        value={selectedStatus}
                        onChange={(e) => setSelectedStatus(e.target.value)}
                        className="w-full px-4 py-3 border-2 border-slate-200 rounded-xl focus:border-blue-500 focus:outline-none transition-colors text-lg font-medium"
                      >
                        {statusTypes.map(type => (
                          <option key={type} value={type}>{type}</option>
                        ))}
                      </select>
                    </div>
                  </div>
                </div>

                <div className="mb-6 flex items-center justify-between">
                  <p className="text-slate-600 text-lg">
                    å…±æ‰¾åˆ° <span className="font-bold text-blue-600 text-2xl">{filteredTrials.length}</span> é …è©¦é©—
                  </p>
                  <div className="flex gap-3">
                    <button
                      onClick={downloadCSV}
                      className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 font-semibold"
                      title="ä¸‹è¼‰ç‚ºExcelæ ¼å¼"
                    >
                      <DownloadIcon />
                      ä¸‹è¼‰ Excel
                    </button>
                    <button
                      onClick={generatePDF}
                      className="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-red-500 to-rose-500 text-white rounded-xl hover:from-red-600 hover:to-rose-600 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 font-semibold"
                      title="åŒ¯å‡ºç‚ºPDF"
                    >
                      <FileTextIcon />
                      åŒ¯å‡º PDF
                    </button>
                  </div>
                </div>

                <div className="space-y-6">
                  {filteredTrials.map(trial => (
                    <TrialCard
                      key={trial.id}
                      trial={trial}
                      isLoggedIn={isLoggedIn}
                      onEdit={handleEdit}
                      onDelete={handleDelete}
                      getStatusColor={getStatusColor}
                      getStatusIcon={getStatusIcon}
                      editingTrial={editingTrial}
                      setEditingTrial={setEditingTrial}
                      handleSaveEdit={handleSaveEdit}
                    />
                  ))}
                </div>

                {filteredTrials.length === 0 && (
                  <div className="text-center py-20">
                    <div className="text-6xl mb-4">ğŸ”</div>
                    <p className="text-2xl text-slate-400 font-semibold">æœªæ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„è©¦é©—</p>
                  </div>
                )}
              </div>

              {showLoginModal && (
                <LoginModal
                  username={username}
                  password={password}
                  setUsername={setUsername}
                  setPassword={setPassword}
                  onLogin={handleLogin}
                  onClose={() => setShowLoginModal(false)}
                />
              )}

              {showAddModal && (
                <AddTrialModal
                  onAdd={handleAdd}
                  onClose={() => setShowAddModal(false)}
                />
              )}
            </div>
          );
        }

        function TrialCard({ trial, isLoggedIn, onEdit, onDelete, getStatusColor, getStatusIcon, editingTrial, setEditingTrial, handleSaveEdit }) {
          const [expanded, setExpanded] = useState(false);
          const enrollmentPercentage = trial.targetNum > 0 ? (trial.enrolled / trial.targetNum * 100) : 0;

          if (editingTrial && editingTrial.id === trial.id) {
            return (
              <div className="bg-white rounded-2xl shadow-lg overflow-hidden border border-slate-200">
                <EditTrialForm
                  trial={editingTrial}
                  setTrial={setEditingTrial}
                  onSave={handleSaveEdit}
                  onCancel={() => setEditingTrial(null)}
                />
              </div>
            );
          }

          return (
            <div className="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden border border-slate-200 transform hover:-translate-y-1 fade-in">
              <div className="p-6">
                <div className="flex justify-between items-start mb-4">
                  <div className="flex-1">
                    <div className="flex items-center gap-3 mb-3">
                      <span className="px-4 py-1.5 bg-gradient-to-r from-blue-500 to-indigo-500 text-white text-sm font-bold rounded-full shadow-md">
                        {trial.cancerType}
                      </span>
                      <span className="px-4 py-1.5 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-sm font-bold rounded-full shadow-md">
                        {trial.line}
                      </span>
                      <span className={`px-4 py-1.5 text-sm font-bold rounded-full flex items-center gap-1.5 shadow-md ${getStatusColor(trial.status)}`}>
                        {getStatusIcon(trial.status)}
                        {trial.status}
                      </span>
                    </div>
                    <h3 className="text-xl font-bold text-slate-800 mb-2 leading-relaxed">
                      {trial.studyTitle}
                    </h3>
                    <div className="flex items-center gap-6 text-sm text-slate-600">
                      <span className="font-semibold">ä»£è™Ÿ: <span className="text-blue-600">{trial.code}</span></span>
                      <span className="font-semibold">æœŸåˆ¥: <span className="text-purple-600">Phase {trial.phase}</span></span>
                      <span className="font-semibold">è´ŠåŠ©å•†: {trial.sponsor}</span>
                    </div>
                  </div>
                  {isLoggedIn && (
                    <div className="flex gap-2 ml-4">
                      <button
                        onClick={() => onEdit(trial)}
                        className="p-2.5 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"
                        title="ç·¨è¼¯"
                      >
                        <EditIcon />
                      </button>
                      <button
                        onClick={() => onDelete(trial.id)}
                        className="p-2.5 text-rose-600 hover:bg-rose-50 rounded-lg transition-colors"
                        title="åˆªé™¤"
                      >
                        <TrashIcon />
                      </button>
                    </div>
                  )}
                </div>

                <div className="mb-4">
                  <div className="flex justify-between text-sm mb-2">
                    <span className="font-semibold text-slate-700">æ”¶æ¡ˆé€²åº¦</span>
                    <span className="font-bold text-blue-600">{trial.enrolled} / {trial.targetNum}</span>
                  </div>
                  <div className="h-3 bg-slate-200 rounded-full overflow-hidden">
                    <div
                      className="h-full bg-gradient-to-r from-blue-500 to-indigo-500 transition-all duration-500 rounded-full"
                      style={{ width: `${Math.min(enrollmentPercentage, 100)}%` }}
                    />
                  </div>
                  <div className="text-right text-xs text-slate-600 mt-1 font-medium">
                    {enrollmentPercentage.toFixed(1)}%
                  </div>
                </div>

                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                  <InfoBox label="ä¸»æŒäºº" value={trial.pi} />
                  <InfoBox label="ç ”ç©¶è­·å£«" value={trial.nurse} />
                  <InfoBox label="ç•¶æœˆç°½ç½²" value={trial.monthSigned} />
                  <InfoBox label="ç•¶æœˆå…¥æ¡ˆ" value={trial.monthEnrolled} />
                </div>

                {expanded && (
                  <div className="mt-4 p-4 bg-slate-50 rounded-xl border border-slate-200">
                    <h4 className="font-bold text-slate-800 mb-2">æ”¶æ¡ˆæ¢ä»¶</h4>
                    <p className="text-slate-700 leading-relaxed">{trial.criteria}</p>
                    {trial.phone && (
                      <p className="text-sm text-slate-600 mt-3">
                        <span className="font-semibold">è¯çµ¡é›»è©±:</span> {trial.phone}
                      </p>
                    )}
                  </div>
                )}

                <button
                  onClick={() => setExpanded(!expanded)}
                  className="mt-4 text-blue-600 hover:text-blue-700 font-semibold text-sm transition-colors"
                >
                  {expanded ? 'æ”¶èµ·è©³æƒ… â–²' : 'å±•é–‹è©³æƒ… â–¼'}
                </button>
              </div>
            </div>
          );
        }

        function InfoBox({ label, value }) {
          return (
            <div className="bg-gradient-to-br from-slate-50 to-blue-50 p-3 rounded-lg border border-slate-200">
              <div className="text-xs text-slate-600 font-semibold mb-1">{label}</div>
              <div className="text-lg font-bold text-slate-800">{value}</div>
            </div>
          );
        }

        function EditTrialForm({ trial, setTrial, onSave, onCancel }) {
          return (
            <div className="p-6 bg-gradient-to-br from-blue-50 to-indigo-50">
              <h3 className="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                <EditIcon />
                ç·¨è¼¯è©¦é©—
              </h3>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <FormField label="è©¦é©—åç¨±" value={trial.studyTitle} onChange={(v) => setTrial({ ...trial, studyTitle: v })} />
                <FormField label="ä»£è™Ÿ" value={trial.code} onChange={(v) => setTrial({ ...trial, code: v })} />
                <FormField label="ç™Œç—‡é¡å‹" value={trial.cancerType} onChange={(v) => setTrial({ ...trial, cancerType: v })} />
                <FormField label="æ²»ç™‚ç·šåˆ¥" value={trial.line} onChange={(v) => setTrial({ ...trial, line: v })} />
                <FormField label="æœŸåˆ¥" value={trial.phase} onChange={(v) => setTrial({ ...trial, phase: v })} />
                <FormField label="è´ŠåŠ©å•†" value={trial.sponsor} onChange={(v) => setTrial({ ...trial, sponsor: v })} />
                <FormField label="ç›®æ¨™äººæ•¸" type="number" value={trial.targetNum} onChange={(v) => setTrial({ ...trial, targetNum: parseInt(v) || 0 })} />
                <FormField label="å·²æ”¶æ¡ˆ" type="number" value={trial.enrolled} onChange={(v) => setTrial({ ...trial, enrolled: parseInt(v) || 0 })} />
                <FormField label="ç•¶æœˆç°½ç½²" type="number" value={trial.monthSigned} onChange={(v) => setTrial({ ...trial, monthSigned: parseInt(v) || 0 })} />
                <FormField label="ç•¶æœˆå…¥æ¡ˆ" type="number" value={trial.monthEnrolled} onChange={(v) => setTrial({ ...trial, monthEnrolled: parseInt(v) || 0 })} />
                <FormField label="ä¸»æŒäºº" value={trial.pi} onChange={(v) => setTrial({ ...trial, pi: v })} />
                <FormField label="ç ”ç©¶è­·å£«" value={trial.nurse} onChange={(v) => setTrial({ ...trial, nurse: v })} />
                <FormField label="é›»è©±" value={trial.phone} onChange={(v) => setTrial({ ...trial, phone: v })} />
                <div>
                  <label className="block text-sm font-semibold text-slate-700 mb-2">ç‹€æ…‹</label>
                  <select
                    value={trial.status}
                    onChange={(e) => setTrial({ ...trial, status: e.target.value })}
                    className="w-full px-4 py-2 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none"
                  >
                    <option value="é€²è¡Œä¸­">é€²è¡Œä¸­</option>
                    <option value="æš«åœæ”¶æ¡ˆ">æš«åœæ”¶æ¡ˆ</option>
                    <option value="åé¡å·²æ»¿">åé¡å·²æ»¿</option>
                  </select>
                </div>
              </div>
              <div className="mb-6">
                <label className="block text-sm font-semibold text-slate-700 mb-2">æ”¶æ¡ˆæ¢ä»¶</label>
                <textarea
                  value={trial.criteria}
                  onChange={(e) => setTrial({ ...trial, criteria: e.target.value })}
                  className="w-full px-4 py-2 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none"
                  rows={4}
                />
              </div>
              <div className="flex gap-3">
                <button
                  onClick={onSave}
                  className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg font-semibold"
                >
                  <SaveIcon />
                  å„²å­˜
                </button>
                <button
                  onClick={onCancel}
                  className="flex items-center gap-2 px-6 py-3 bg-slate-300 text-slate-700 rounded-xl hover:bg-slate-400 transition-all font-semibold"
                >
                  <XIcon />
                  å–æ¶ˆ
                </button>
              </div>
            </div>
          );
        }

        function FormField({ label, value, onChange, type = "text" }) {
          return (
            <div>
              <label className="block text-sm font-semibold text-slate-700 mb-2">{label}</label>
              <input
                type={type}
                value={value}
                onChange={(e) => onChange(e.target.value)}
                className="w-full px-4 py-2 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none"
              />
            </div>
          );
        }

        function LoginModal({ username, password, setUsername, setPassword, onLogin, onClose }) {
          return (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm">
              <div className="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl">
                <h2 className="text-3xl font-bold text-slate-800 mb-6">ç®¡ç†å“¡ç™»å…¥</h2>
                <div className="space-y-4 mb-6">
                  <div>
                    <label className="block text-sm font-semibold text-slate-700 mb-2">å¸³è™Ÿ</label>
                    <input
                      type="text"
                      value={username}
                      onChange={(e) => setUsername(e.target.value)}
                      className="w-full px-4 py-3 border-2 border-slate-300 rounded-xl focus:border-blue-500 focus:outline-none"
                      placeholder="è«‹è¼¸å…¥å¸³è™Ÿ"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold text-slate-700 mb-2">å¯†ç¢¼</label>
                    <input
                      type="password"
                      value={password}
                      onChange={(e) => setPassword(e.target.value)}
                      onKeyPress={(e) => e.key === 'Enter' && onLogin()}
                      className="w-full px-4 py-3 border-2 border-slate-300 rounded-xl focus:border-blue-500 focus:outline-none"
                      placeholder="è«‹è¼¸å…¥å¯†ç¢¼"
                    />
                  </div>
                </div>
                <div className="flex gap-3">
                  <button
                    onClick={onLogin}
                    className="flex-1 px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-xl hover:from-blue-600 hover:to-indigo-600 transition-all shadow-lg font-semibold"
                  >
                    ç™»å…¥
                  </button>
                  <button
                    onClick={onClose}
                    className="flex-1 px-6 py-3 bg-slate-300 text-slate-700 rounded-xl hover:bg-slate-400 transition-all font-semibold"
                  >
                    å–æ¶ˆ
                  </button>
                </div>
                <p className="text-sm text-slate-500 mt-4 text-center">
                  é è¨­å¸³è™Ÿ: admin / å¯†ç¢¼: admin123
                </p>
              </div>
            </div>
          );
        }

        function AddTrialModal({ onAdd, onClose }) {
          const [newTrial, setNewTrial] = useState({
            cancerType: 'èƒƒç™Œ',
            line: 'ä¸€ç·š',
            studyTitle: '',
            code: '',
            phase: 'III',
            sponsor: '',
            targetNum: 0,
            enrolled: 0,
            monthSigned: 0,
            monthEnrolled: 0,
            pi: '',
            nurse: '',
            phone: '',
            status: 'é€²è¡Œä¸­',
            criteria: ''
          });

          const handleSubmit = () => {
            if (!newTrial.studyTitle || !newTrial.code) {
              alert('è«‹å¡«å¯«è©¦é©—åç¨±å’Œä»£è™Ÿ');
              return;
            }
            onAdd(newTrial);
          };

          return (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm overflow-y-auto">
              <div className="bg-white rounded-2xl p-8 max-w-4xl w-full mx-4 my-8 shadow-2xl">
                <h2 className="text-3xl font-bold text-slate-800 mb-6">æ–°å¢è©¦é©—</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 max-h-96 overflow-y-auto">
                  <FormField label="è©¦é©—åç¨± *" value={newTrial.studyTitle} onChange={(v) => setNewTrial({ ...newTrial, studyTitle: v })} />
                  <FormField label="ä»£è™Ÿ *" value={newTrial.code} onChange={(v) => setNewTrial({ ...newTrial, code: v })} />
                  <FormField label="ç™Œç—‡é¡å‹" value={newTrial.cancerType} onChange={(v) => setNewTrial({ ...newTrial, cancerType: v })} />
                  <FormField label="æ²»ç™‚ç·šåˆ¥" value={newTrial.line} onChange={(v) => setNewTrial({ ...newTrial, line: v })} />
                  <FormField label="æœŸåˆ¥" value={newTrial.phase} onChange={(v) => setNewTrial({ ...newTrial, phase: v })} />
                  <FormField label="è´ŠåŠ©å•†" value={newTrial.sponsor} onChange={(v) => setNewTrial({ ...newTrial, sponsor: v })} />
                  <FormField label="ç›®æ¨™äººæ•¸" type="number" value={newTrial.targetNum} onChange={(v) => setNewTrial({ ...newTrial, targetNum: parseInt(v) || 0 })} />
                  <FormField label="å·²æ”¶æ¡ˆ" type="number" value={newTrial.enrolled} onChange={(v) => setNewTrial({ ...newTrial, enrolled: parseInt(v) || 0 })} />
                  <FormField label="ä¸»æŒäºº" value={newTrial.pi} onChange={(v) => setNewTrial({ ...newTrial, pi: v })} />
                  <FormField label="ç ”ç©¶è­·å£«" value={newTrial.nurse} onChange={(v) => setNewTrial({ ...newTrial, nurse: v })} />
                  <FormField label="é›»è©±" value={newTrial.phone} onChange={(v) => setNewTrial({ ...newTrial, phone: v })} />
                  <div>
                    <label className="block text-sm font-semibold text-slate-700 mb-2">ç‹€æ…‹</label>
                    <select
                      value={newTrial.status}
                      onChange={(e) => setNewTrial({ ...newTrial, status: e.target.value })}
                      className="w-full px-4 py-2 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none"
                    >
                      <option value="é€²è¡Œä¸­">é€²è¡Œä¸­</option>
                      <option value="æš«åœæ”¶æ¡ˆ">æš«åœæ”¶æ¡ˆ</option>
                      <option value="åé¡å·²æ»¿">åé¡å·²æ»¿</option>
                    </select>
                  </div>
                </div>
                <div className="mb-6">
                  <label className="block text-sm font-semibold text-slate-700 mb-2">æ”¶æ¡ˆæ¢ä»¶</label>
                  <textarea
                    value={newTrial.criteria}
                    onChange={(e) => setNewTrial({ ...newTrial, criteria: e.target.value })}
                    className="w-full px-4 py-2 border-2 border-slate-300 rounded-lg focus:border-blue-500 focus:outline-none"
                    rows={4}
                  />
                </div>
                <div className="flex gap-3">
                  <button
                    onClick={handleSubmit}
                    className="flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all shadow-lg font-semibold"
                  >
                    <PlusIcon />
                    æ–°å¢
                  </button>
                  <button
                    onClick={onClose}
                    className="flex-1 px-6 py-3 bg-slate-300 text-slate-700 rounded-xl hover:bg-slate-400 transition-all font-semibold"
                  >
                    å–æ¶ˆ
                  </button>
                </div>
              </div>
            </div>
          );
        }

        ReactDOM.render(<ClinicalTrialsManager />, document.getElementById('app'));
    </script>
</body>
</html>
